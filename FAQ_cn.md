
![](imgs/FAQ.jpg)

[English](./README.md) | 简体中文

# FAQ

## 常见问题

### 不同平台推理结果不同

受BPU代次影响，推理结果有略微差异是正常现像，如果差异很大，请提前往地瓜开发者社区进行反馈。


### 自己训练的模型运行效果不满足预期。

- 请检查OpenExplore工具链Docker, 板端libdnn.so的版本是否均为目前发布的最新版本.
- 请检查在导出模型时，是否有按照对应examples的文件夹内的README的要求进行。


### 模型推理性能达不到参考性能

以下因素可能导致推理性能有差异:

- Python API 的推理性能会较弱一些，请基于 C/C++ API 测试性能。

- 性能数据不包含前后处理，与完整demo的耗时是存在差异的，一般来说采用nv12输入的模型可以做到end2end吞吐量等于BPU吞吐量。
- 板子是否已经定频到对应README内的最高频率。
- 是否有其他应用占用了 CPU/BPU 及 DDR 带宽资源，这会导致推理性能减弱。


### 如何解决模型量化掉精度问题

- 根据平台版本，先参考对应平台的文档，参考PTQ章节的精度debug章节进行精度debug。
- 如果是模型结构特性、权重分布导致 int8 量化掉精度，请考虑使用混合量化或QAT量化。


### 为什么其他模型没有demo，是因为不支持吗

你好，不是。受限于项目排期，为了照顾大部分地瓜开发者的需求，我们挑选了提问频率较高的模型作为demo示例。如果有更好的模型推荐，欢迎前往地瓜开发者社区反馈。


### mAP 精度相比ultralytics官方的结果低一些

- ultralytics官方测mAP时，使用动态shape模型, 而BPU使用了固定shape模型，map测试结果会比动态shape的低一些。
- RDK Solutions使用pycocotools计算的精度比ultralytics计算的精度会低一些是正常现象, 主要原因是两者计算方法有细微差异, 我们主要是关注同样的一套计算方式去测试定点模型和浮点模型的精度, 从而来评估量化过程中的精度损失.
- BPU 模型在量化和NCHW-RGB888输入转换为YUV420SP(nv12)输入后, 也会有一部分精度损失。


### 不修改YOLO模型结构直接导出的ONNX可以使用吗

可以，但不推荐。

- 公版的模型结构或者自己设计的输出头结构，需要自行对后处理代码进行程序设计。

- RDK Solutions仓库提供的模型结构的调整方式是经过了精度和性能的考虑, 其他的修改方法暂未经过测试，也欢迎大家探索更多的高性能和高精度的修改方法。
